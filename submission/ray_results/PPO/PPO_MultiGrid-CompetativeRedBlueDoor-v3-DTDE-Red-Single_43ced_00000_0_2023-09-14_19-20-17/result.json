{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5752980851568281, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0015026978398964275, "policy_loss": -0.014585274214429471, "vf_loss": 0.011557682377072828, "vf_explained_var": 0.2721199785048763, "kl": 0.007624468694188215, "entropy": 1.938346886759003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.05705542176896, "num_env_steps_trained_throughput_per_sec": 74.05705542176896, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 54012.357, "sample_time_ms": 14024.937, "learn_time_ms": 39904.318, "learn_throughput": 100.24, "synch_weights_time_ms": 81.643}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "43ced_00000", "date": "2023-09-14_19-21-22", "timestamp": 1694733682, "time_this_iter_s": 54.022294759750366, "time_total_s": 54.022294759750366, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b6f164040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 54.022294759750366, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 82.9782051282051, "ram_util_percent": 7.983333333333335}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7177453123964369, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0016067045139910381, "policy_loss": -0.015471161018407049, "vf_loss": 0.014620638322958257, "vf_explained_var": 0.16113589617113272, "kl": 0.012286139433493402, "entropy": 1.924208850041032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 1.0537499999999997, "episode_reward_min": 1.0471874999999984, "episode_reward_mean": 1.050468749999999, "episode_len_mean": 620.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 1.0471874999999984}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 1.050468749999999}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984], "episode_lengths": [618, 622], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53148680411921, "mean_inference_ms": 2.5305884905373413, "mean_action_processing_ms": 0.1634415913461597, "mean_env_wait_ms": 0.2725889322611872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12428760528564453, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 0.17447471618652344}}, "episode_reward_max": 1.0537499999999997, "episode_reward_min": 1.0471874999999984, "episode_reward_mean": 1.050468749999999, "episode_len_mean": 620.0, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 1.0471874999999984}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 1.050468749999999}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984], "episode_lengths": [618, 622], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53148680411921, "mean_inference_ms": 2.5305884905373413, "mean_action_processing_ms": 0.1634415913461597, "mean_env_wait_ms": 0.2725889322611872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12428760528564453, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 0.17447471618652344}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 62.02236242440057, "num_env_steps_trained_throughput_per_sec": 62.02236242440057, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 59252.591, "sample_time_ms": 14832.795, "learn_time_ms": 44339.921, "learn_throughput": 90.212, "synch_weights_time_ms": 78.648}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "43ced_00000", "date": "2023-09-14_19-22-26", "timestamp": 1694733746, "time_this_iter_s": 64.5003776550293, "time_total_s": 118.52267241477966, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f088abd7370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 118.52267241477966, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 85.52499999999999, "ram_util_percent": 8.65}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8320991570750872, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015383629882126115, "policy_loss": -0.018262317770859227, "vf_loss": 0.0008720314321484086, "vf_explained_var": 0.6381598718464374, "kl": 0.010033284642901208, "entropy": 1.9115174622585376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 1.0537499999999997, "episode_reward_min": 1.0471874999999984, "episode_reward_mean": 1.050468749999999, "episode_len_mean": 620.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 1.0471874999999984}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 1.050468749999999}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984], "episode_lengths": [618, 622], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53148680411921, "mean_inference_ms": 2.5305884905373413, "mean_action_processing_ms": 0.1634415913461597, "mean_env_wait_ms": 0.2725889322611872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12428760528564453, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 0.17447471618652344}}, "episode_reward_max": 1.0537499999999997, "episode_reward_min": 1.0471874999999984, "episode_reward_mean": 1.050468749999999, "episode_len_mean": 620.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 1.0471874999999984}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 1.050468749999999}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984], "episode_lengths": [618, 622], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53148680411921, "mean_inference_ms": 2.5305884905373413, "mean_action_processing_ms": 0.1634415913461597, "mean_env_wait_ms": 0.2725889322611872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12428760528564453, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 0.17447471618652344}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.56106480753327, "num_env_steps_trained_throughput_per_sec": 81.56106480753327, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 55849.382, "sample_time_ms": 14907.096, "learn_time_ms": 40867.847, "learn_throughput": 97.876, "synch_weights_time_ms": 73.246}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 2, "training_iteration": 3, "trial_id": "43ced_00000", "date": "2023-09-14_19-23-16", "timestamp": 1694733796, "time_this_iter_s": 49.05001640319824, "time_total_s": 167.5726888179779, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b1c2eec20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 167.5726888179779, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 81.80428571428571, "ram_util_percent": 8.720000000000004}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.2, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9525773644447326, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013000342243321939, "policy_loss": -0.02074875345036465, "vf_loss": 0.004863538387447382, "vf_explained_var": 0.6666415763398011, "kl": 0.014424364176166054, "entropy": 1.8733632194499175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 1.0537499999999997, "episode_reward_min": 0.46906249999999616, "episode_reward_mean": 0.5879062499999967, "episode_len_mean": 1148.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.46906249999999616}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 0.5879062499999967}, "custom_metrics": {"red_0/door_open_done_mean": 0.2, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5360149066280391, "mean_inference_ms": 2.660298718059064, "mean_action_processing_ms": 0.16905804193532595, "mean_env_wait_ms": 0.28082875231967014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11358022689819336, "StateBufferConnector_ms": 0.007476806640625, "ViewRequirementAgentConnector_ms": 0.15086650848388672}}, "episode_reward_max": 1.0537499999999997, "episode_reward_min": 0.46906249999999616, "episode_reward_mean": 0.5879062499999967, "episode_len_mean": 1148.0, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.46906249999999616}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 0.5879062499999967}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5360149066280391, "mean_inference_ms": 2.660298718059064, "mean_action_processing_ms": 0.16905804193532595, "mean_env_wait_ms": 0.28082875231967014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11358022689819336, "StateBufferConnector_ms": 0.007476806640625, "ViewRequirementAgentConnector_ms": 0.15086650848388672}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.38299233455584, "num_env_steps_trained_throughput_per_sec": 71.38299233455584, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 55895.967, "sample_time_ms": 14737.24, "learn_time_ms": 41084.907, "learn_throughput": 97.359, "synch_weights_time_ms": 72.687}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "43ced_00000", "date": "2023-09-14_19-24-12", "timestamp": 1694733852, "time_this_iter_s": 56.04410791397095, "time_total_s": 223.61679673194885, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f088abd75b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 223.61679673194885, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 83.86125, "ram_util_percent": 8.778749999999999}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.23076923076923078, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.031796244997531, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006619373022022046, "policy_loss": -0.013556674637463099, "vf_loss": 0.004698664315947098, "vf_explained_var": 0.43413449451327324, "kl": 0.011193186543328989, "entropy": 1.8627127159386874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 1.0537499999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.6014122596153813, "episode_len_mean": 1133.1538461538462, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 0.6014122596153813}, "custom_metrics": {"red_0/door_open_done_mean": 0.23076923076923078, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348198402141181, "mean_inference_ms": 2.638023425651162, "mean_action_processing_ms": 0.16860274180667678, "mean_env_wait_ms": 0.2799459665980927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11942386627197266, "StateBufferConnector_ms": 0.008113567645733174, "ViewRequirementAgentConnector_ms": 0.15686842111440805}}, "episode_reward_max": 1.0537499999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.6014122596153813, "episode_len_mean": 1133.1538461538462, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.0537499999999997}, "policy_reward_mean": {"red_0": 0.6014122596153813}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348198402141181, "mean_inference_ms": 2.638023425651162, "mean_action_processing_ms": 0.16860274180667678, "mean_env_wait_ms": 0.2799459665980927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11942386627197266, "StateBufferConnector_ms": 0.008113567645733174, "ViewRequirementAgentConnector_ms": 0.15686842111440805}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.33042471129804, "num_env_steps_trained_throughput_per_sec": 81.33042471129804, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 54553.184, "sample_time_ms": 14659.814, "learn_time_ms": 39818.934, "learn_throughput": 100.455, "synch_weights_time_ms": 73.348}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 13, "training_iteration": 5, "trial_id": "43ced_00000", "date": "2023-09-14_19-25-01", "timestamp": 1694733901, "time_this_iter_s": 49.18947243690491, "time_total_s": 272.80626916885376, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f088abd5ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 272.80626916885376, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 82.24571428571429, "ram_util_percent": 8.872857142857141}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.4117647058823529, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0850048317263523, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0031160670914687216, "policy_loss": -0.01712991419141569, "vf_loss": 0.011717276164563372, "vf_explained_var": 0.34324567262083294, "kl": 0.01148285536645265, "entropy": 1.8446016496668258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 1.3865624999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.6951746323529383, "episode_len_mean": 1029.0588235294117, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.3865624999999997}, "policy_reward_mean": {"red_0": 0.6951746323529383}, "custom_metrics": {"red_0/door_open_done_mean": 0.4117647058823529, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334087743027526, "mean_inference_ms": 2.617541175245949, "mean_action_processing_ms": 0.16804898963274328, "mean_env_wait_ms": 0.279307258114857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11406365562887753, "StateBufferConnector_ms": 0.007857995874741498, "ViewRequirementAgentConnector_ms": 0.15243922962861903}}, "episode_reward_max": 1.3865624999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.6951746323529383, "episode_len_mean": 1029.0588235294117, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.3865624999999997}, "policy_reward_mean": {"red_0": 0.6951746323529383}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334087743027526, "mean_inference_ms": 2.617541175245949, "mean_action_processing_ms": 0.16804898963274328, "mean_env_wait_ms": 0.279307258114857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11406365562887753, "StateBufferConnector_ms": 0.007857995874741498, "ViewRequirementAgentConnector_ms": 0.15243922962861903}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.85952997479517, "num_env_steps_trained_throughput_per_sec": 84.85952997479517, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 53317.1, "sample_time_ms": 14463.651, "learn_time_ms": 38781.281, "learn_throughput": 103.143, "synch_weights_time_ms": 71.117}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 17, "training_iteration": 6, "trial_id": "43ced_00000", "date": "2023-09-14_19-25-49", "timestamp": 1694733949, "time_this_iter_s": 47.14558219909668, "time_total_s": 319.95185136795044, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f08a8203be0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 319.95185136795044, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 82.56617647058825, "ram_util_percent": 8.970588235294118}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.4166666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2647319990520676, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006213665393806878, "policy_loss": -0.019896728989260738, "vf_loss": 0.01082503685587047, "vf_explained_var": 0.454041896512111, "kl": 0.014290134288870845, "entropy": 1.7882062987734875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 1.3865624999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.7072721354166637, "episode_len_mean": 1013.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.3865624999999997}, "policy_reward_mean": {"red_0": 0.7072721354166637}, "custom_metrics": {"red_0/door_open_done_mean": 0.4166666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326563121535356, "mean_inference_ms": 2.618366779356346, "mean_action_processing_ms": 0.16764650219928748, "mean_env_wait_ms": 0.27818668768737814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11560320854187012, "StateBufferConnector_ms": 0.007981061935424805, "ViewRequirementAgentConnector_ms": 0.15778442223866782}}, "episode_reward_max": 1.3865624999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.7072721354166637, "episode_len_mean": 1013.0, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.3865624999999997}, "policy_reward_mean": {"red_0": 0.7072721354166637}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326563121535356, "mean_inference_ms": 2.618366779356346, "mean_action_processing_ms": 0.16764650219928748, "mean_env_wait_ms": 0.27818668768737814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11560320854187012, "StateBufferConnector_ms": 0.007981061935424805, "ViewRequirementAgentConnector_ms": 0.15778442223866782}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.51860361441987, "num_env_steps_trained_throughput_per_sec": 86.51860361441987, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 52305.057, "sample_time_ms": 14365.072, "learn_time_ms": 37868.982, "learn_throughput": 105.627, "synch_weights_time_ms": 69.97}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 24, "training_iteration": 7, "trial_id": "43ced_00000", "date": "2023-09-14_19-26-35", "timestamp": 1694733995, "time_this_iter_s": 46.24070477485657, "time_total_s": 366.192556142807, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f088ab29f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 366.192556142807, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 81.73939393939395, "ram_util_percent": 9.036363636363635}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.5172413793103449, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.311115474626422, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0019365149662917247, "policy_loss": -0.016373336263738263, "vf_loss": 0.01584920066379709, "vf_explained_var": 0.3125309055671096, "kl": 0.012303253786653413, "entropy": 1.7853686461846034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 1.3865624999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.7749084051724108, "episode_len_mean": 933.3793103448276, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.3865624999999997}, "policy_reward_mean": {"red_0": 0.7749084051724108}, "custom_metrics": {"red_0/door_open_done_mean": 0.5172413793103449, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5306873879820135, "mean_inference_ms": 2.598057249714452, "mean_action_processing_ms": 0.16709673349879375, "mean_env_wait_ms": 0.2772948169498547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11261167197391905, "StateBufferConnector_ms": 0.007935228018925107, "ViewRequirementAgentConnector_ms": 0.1546571994649953}}, "episode_reward_max": 1.3865624999999997, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.7749084051724108, "episode_len_mean": 933.3793103448276, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.3865624999999997}, "policy_reward_mean": {"red_0": 0.7749084051724108}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5306873879820135, "mean_inference_ms": 2.598057249714452, "mean_action_processing_ms": 0.16709673349879375, "mean_env_wait_ms": 0.2772948169498547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11261167197391905, "StateBufferConnector_ms": 0.007935228018925107, "ViewRequirementAgentConnector_ms": 0.1546571994649953}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.49594270284268, "num_env_steps_trained_throughput_per_sec": 83.49594270284268, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 51755.236, "sample_time_ms": 14332.343, "learn_time_ms": 37352.754, "learn_throughput": 107.087, "synch_weights_time_ms": 69.121}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 29, "training_iteration": 8, "trial_id": "43ced_00000", "date": "2023-09-14_19-27-23", "timestamp": 1694734043, "time_this_iter_s": 47.914326429367065, "time_total_s": 414.1068825721741, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b1c2ee8c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 414.1068825721741, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 82.03676470588236, "ram_util_percent": 9.139705882352944}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.6666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4987708407764633, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01991850218522207, "policy_loss": -0.02329520621812359, "vf_loss": 0.040420446315935506, "vf_explained_var": 0.2571872459103664, "kl": 0.013966309105426167, "entropy": 1.7426040636996427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 1.4552343749999999, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.8852585565476166, "episode_len_mean": 801.5, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.4552343749999999}, "policy_reward_mean": {"red_0": 0.8852585565476166}, "custom_metrics": {"red_0/door_open_done_mean": 0.6666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5312722933578458, "mean_inference_ms": 2.5975713716346513, "mean_action_processing_ms": 0.16646851168666463, "mean_env_wait_ms": 0.2762568022656101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11801719665527344, "StateBufferConnector_ms": 0.008114178975423178, "ViewRequirementAgentConnector_ms": 0.15747149785359701}}, "episode_reward_max": 1.4552343749999999, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 0.8852585565476166, "episode_len_mean": 801.5, "episodes_this_iter": 13, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.4552343749999999}, "policy_reward_mean": {"red_0": 0.8852585565476166}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5312722933578458, "mean_inference_ms": 2.5975713716346513, "mean_action_processing_ms": 0.16646851168666463, "mean_env_wait_ms": 0.2762568022656101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11801719665527344, "StateBufferConnector_ms": 0.008114178975423178, "ViewRequirementAgentConnector_ms": 0.15747149785359701}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.91095062934146, "num_env_steps_trained_throughput_per_sec": 82.91095062934146, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 51365.154, "sample_time_ms": 14211.488, "learn_time_ms": 37084.292, "learn_throughput": 107.862, "synch_weights_time_ms": 68.367}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 42, "training_iteration": 9, "trial_id": "43ced_00000", "date": "2023-09-14_19-28-12", "timestamp": 1694734092, "time_this_iter_s": 48.253387212753296, "time_total_s": 462.36026978492737, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f088ab2b370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 462.36026978492737, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 83.0142857142857, "ram_util_percent": 9.272857142857138}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.75, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6381225227067868, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.032083406940607045, "policy_loss": -0.01782753579027485, "vf_loss": 0.046994742318444575, "vf_explained_var": 0.5305825210486849, "kl": 0.014581001773216234, "entropy": 1.6673634126782417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 1.4740625, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 1.0031068638392837, "episode_len_mean": 650.3392857142857, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.4740625}, "policy_reward_mean": {"red_0": 1.0031068638392837}, "custom_metrics": {"red_0/door_open_done_mean": 0.75, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890, 256, 63, 154, 141, 36, 93, 354, 89, 741, 87, 130, 256, 251, 105], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5302709602982023, "mean_inference_ms": 2.5917880251900516, "mean_action_processing_ms": 0.16583153286871538, "mean_env_wait_ms": 0.2754583959810127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11613028390066964, "StateBufferConnector_ms": 0.007961477552141463, "ViewRequirementAgentConnector_ms": 0.15540591308048793}}, "episode_reward_max": 1.4740625, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 1.0031068638392837, "episode_len_mean": 650.3392857142857, "episodes_this_iter": 14, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.4740625}, "policy_reward_mean": {"red_0": 1.0031068638392837}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890, 256, 63, 154, 141, 36, 93, 354, 89, 741, 87, 130, 256, 251, 105], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5302709602982023, "mean_inference_ms": 2.5917880251900516, "mean_action_processing_ms": 0.16583153286871538, "mean_env_wait_ms": 0.2754583959810127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11613028390066964, "StateBufferConnector_ms": 0.007961477552141463, "ViewRequirementAgentConnector_ms": 0.15540591308048793}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.07160644800913, "num_env_steps_trained_throughput_per_sec": 68.07160644800913, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 52104.8, "sample_time_ms": 14159.132, "learn_time_ms": 37875.226, "learn_throughput": 105.61, "synch_weights_time_ms": 69.451}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 56, "training_iteration": 10, "trial_id": "43ced_00000", "date": "2023-09-14_19-29-11", "timestamp": 1694734151, "time_this_iter_s": 58.77060627937317, "time_total_s": 521.1308760643005, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f088ab2a290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 521.1308760643005, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.15119047619048, "ram_util_percent": 9.344047619047618}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.7972972972972973, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7121409953882296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02113946793191038, "policy_loss": -0.019402428265069223, "vf_loss": 0.03799609576720589, "vf_explained_var": 0.6746077926208576, "kl": 0.012729001636456043, "entropy": 1.6550081878900529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 1.4740625, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 1.0773585304054039, "episode_len_mean": 554.4054054054054, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.4740625}, "policy_reward_mean": {"red_0": 1.0773585304054039}, "custom_metrics": {"red_0/door_open_done_mean": 0.7972972972972973, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890, 256, 63, 154, 141, 36, 93, 354, 89, 741, 87, 130, 256, 251, 105, 275, 51, 104, 122, 731, 56, 164, 836, 105, 217, 156, 64, 57, 1280, 140, 45, 61, 143], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5306518075993022, "mean_inference_ms": 2.601064065751894, "mean_action_processing_ms": 0.16561908875989753, "mean_env_wait_ms": 0.27510676120655303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11644137872231973, "StateBufferConnector_ms": 0.007884566848342484, "ViewRequirementAgentConnector_ms": 0.15681337665867162}}, "episode_reward_max": 1.4740625, "episode_reward_min": 0.46890624999999525, "episode_reward_mean": 1.0773585304054039, "episode_len_mean": 554.4054054054054, "episodes_this_iter": 18, "policy_reward_min": {"red_0": 0.46890624999999525}, "policy_reward_max": {"red_0": 1.4740625}, "policy_reward_mean": {"red_0": 1.0773585304054039}, "hist_stats": {"episode_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997], "episode_lengths": [618, 622, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 691, 1280, 1280, 864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890, 256, 63, 154, 141, 36, 93, 354, 89, 741, 87, 130, 256, 251, 105, 275, 51, 104, 122, 731, 56, 164, 836, 105, 217, 156, 64, 57, 1280, 140, 45, 61, 143], "policy_red_0_reward": [1.0537499999999997, 1.0471874999999984, 0.4710937499999957, 0.4724999999999963, 0.47281249999999747, 0.46906249999999616, 0.472968749999996, 0.4715624999999958, 0.4749999999999965, 0.4731249999999958, 0.9986718749999979, 0.46890624999999525, 0.47171874999999674, 0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5306518075993022, "mean_inference_ms": 2.601064065751894, "mean_action_processing_ms": 0.16561908875989753, "mean_env_wait_ms": 0.27510676120655303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11644137872231973, "StateBufferConnector_ms": 0.007884566848342484, "ViewRequirementAgentConnector_ms": 0.15681337665867162}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.94601776350277, "num_env_steps_trained_throughput_per_sec": 72.94601776350277, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 52187.067, "sample_time_ms": 14106.434, "learn_time_ms": 38010.275, "learn_throughput": 105.235, "synch_weights_time_ms": 69.391}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 74, "training_iteration": 11, "trial_id": "43ced_00000", "date": "2023-09-14_19-30-06", "timestamp": 1694734206, "time_this_iter_s": 54.84846520423889, "time_total_s": 575.9793412685394, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b1c1ec9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 575.9793412685394, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 83.7602564102564, "ram_util_percent": 9.439743589743589}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.94, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7652010931943853, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0335991383852767, "policy_loss": -0.027492648435387915, "vf_loss": 0.05605439434099632, "vf_explained_var": 0.4737311172609528, "kl": 0.025186961035380286, "entropy": 1.5641291948656242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 1.4740625, "episode_reward_min": 0.4707812499999955, "episode_reward_mean": 1.2661101562499992, "episode_len_mean": 313.47, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {"red_0": 0.4707812499999955}, "policy_reward_max": {"red_0": 1.4740625}, "policy_reward_mean": {"red_0": 1.2661101562499992}, "custom_metrics": {"red_0/door_open_done_mean": 0.94, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875], "episode_lengths": [864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890, 256, 63, 154, 141, 36, 93, 354, 89, 741, 87, 130, 256, 251, 105, 275, 51, 104, 122, 731, 56, 164, 836, 105, 217, 156, 64, 57, 1280, 140, 45, 61, 143, 87, 85, 55, 68, 59, 145, 106, 88, 86, 224, 100, 58, 64, 81, 115, 87, 57, 1280, 183, 71, 649, 55, 56, 43, 54, 36, 80, 49, 99, 65, 169, 58, 84, 54, 56, 132, 41, 103, 70], "policy_red_0_reward": [0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5288856202718883, "mean_inference_ms": 2.581829022096771, "mean_action_processing_ms": 0.1644978958283824, "mean_env_wait_ms": 0.27364836543648957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11440587043762207, "StateBufferConnector_ms": 0.00886392593383789, "ViewRequirementAgentConnector_ms": 0.15538930892944336}}, "episode_reward_max": 1.4740625, "episode_reward_min": 0.4707812499999955, "episode_reward_mean": 1.2661101562499992, "episode_len_mean": 313.47, "episodes_this_iter": 39, "policy_reward_min": {"red_0": 0.4707812499999955}, "policy_reward_max": {"red_0": 1.4740625}, "policy_reward_mean": {"red_0": 1.2661101562499992}, "hist_stats": {"episode_reward": [0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875], "episode_lengths": [864, 769, 158, 972, 1280, 1280, 563, 1280, 1280, 545, 590, 601, 865, 298, 362, 630, 786, 143, 213, 200, 1133, 64, 233, 510, 213, 61, 1165, 984, 890, 256, 63, 154, 141, 36, 93, 354, 89, 741, 87, 130, 256, 251, 105, 275, 51, 104, 122, 731, 56, 164, 836, 105, 217, 156, 64, 57, 1280, 140, 45, 61, 143, 87, 85, 55, 68, 59, 145, 106, 88, 86, 224, 100, 58, 64, 81, 115, 87, 57, 1280, 183, 71, 649, 55, 56, 43, 54, 36, 80, 49, 99, 65, 169, 58, 84, 54, 56, 132, 41, 103, 70], "policy_red_0_reward": [0.8756249999999979, 0.946796874999998, 1.3865624999999997, 0.7906249999999976, 0.4707812499999955, 0.47312499999999585, 1.090546874999998, 0.4739062499999963, 0.47156249999999594, 1.1039843749999982, 1.0726562499999983, 1.063671874999998, 0.8736718749999974, 1.2803124999999989, 1.2378124999999986, 1.042343749999998, 0.9279687499999972, 1.3966406249999996, 1.3450781249999992, 1.3528124999999993, 0.6738281249999958, 1.4532812499999999, 1.3305468749999994, 1.1329687499999987, 1.3436718749999992, 1.4552343749999999, 0.6574218749999972, 0.7835937499999965, 0.8554687499999971, 1.31015625, 1.4530468749999998, 1.3889062499999996, 1.3978906249999998, 1.4740625, 1.433046875, 1.242187499999999, 1.4350781249999995, 0.9633593749999976, 1.4361718749999997, 1.4046874999999994, 1.313593749999999, 1.316796874999999, 1.4241406249999997, 1.3002343749999992, 1.461015625, 1.4210937499999996, 1.4098437499999996, 0.9722656249999981, 1.459375, 1.3803124999999992, 0.8939062499999975, 1.4239843749999999, 1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5288856202718883, "mean_inference_ms": 2.581829022096771, "mean_action_processing_ms": 0.1644978958283824, "mean_env_wait_ms": 0.27364836543648957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11440587043762207, "StateBufferConnector_ms": 0.00886392593383789, "ViewRequirementAgentConnector_ms": 0.15538930892944336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.5094597486733, "num_env_steps_trained_throughput_per_sec": 78.5094597486733, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 50832.707, "sample_time_ms": 14010.963, "learn_time_ms": 36751.54, "learn_throughput": 108.839, "synch_weights_time_ms": 69.204}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 113, "training_iteration": 12, "trial_id": "43ced_00000", "date": "2023-09-14_19-30-57", "timestamp": 1694734257, "time_this_iter_s": 50.97212219238281, "time_total_s": 626.9514634609222, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b1c2ef490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 626.9514634609222, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 82.31917808219178, "ram_util_percent": 9.517808219178082}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.97, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.714124799395601, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.019799111297470518, "policy_loss": -0.026404142699902877, "vf_loss": 0.041502254215689996, "vf_explained_var": 0.24423132222145796, "kl": 0.015669998317821485, "entropy": 1.5245267735173305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 1.48015625, "episode_reward_min": 0.47109374999999554, "episode_reward_mean": 1.4066234374999993, "episode_len_mean": 124.0, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {"red_0": 0.47109374999999554}, "policy_reward_max": {"red_0": 1.48015625}, "policy_reward_mean": {"red_0": 1.4066234374999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.97, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875, 1.4049999999999998, 1.47078125, 1.4220312499999996, 1.448203125, 1.4330468749999998, 1.468046875, 1.47265625, 1.454453125, 1.4657031249999997, 1.47125, 1.423671875, 1.309453124999999, 1.4450781249999998, 1.4358593749999997, 1.4765625, 1.4119531249999997, 1.4637499999999999, 1.4674218749999999, 1.4721093749999998, 1.472265625, 1.3946874999999996, 1.46078125, 1.4772656249999998, 1.4772656249999998, 1.4771874999999999, 1.3890624999999996, 1.4408593749999996, 1.462265625, 1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125], "episode_lengths": [217, 156, 64, 57, 1280, 140, 45, 61, 143, 87, 85, 55, 68, 59, 145, 106, 88, 86, 224, 100, 58, 64, 81, 115, 87, 57, 1280, 183, 71, 649, 55, 56, 43, 54, 36, 80, 49, 99, 65, 169, 58, 84, 54, 56, 132, 41, 103, 70, 130, 40, 106, 71, 91, 45, 38, 63, 47, 40, 103, 259, 75, 89, 32, 121, 50, 45, 39, 39, 146, 54, 31, 31, 32, 154, 81, 53, 169, 48, 42, 34, 59, 35, 87, 1280, 81, 28, 47, 80, 64, 48, 42, 141, 88, 74, 103, 37, 83, 185, 79, 146], "policy_red_0_reward": [1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875, 1.4049999999999998, 1.47078125, 1.4220312499999996, 1.448203125, 1.4330468749999998, 1.468046875, 1.47265625, 1.454453125, 1.4657031249999997, 1.47125, 1.423671875, 1.309453124999999, 1.4450781249999998, 1.4358593749999997, 1.4765625, 1.4119531249999997, 1.4637499999999999, 1.4674218749999999, 1.4721093749999998, 1.472265625, 1.3946874999999996, 1.46078125, 1.4772656249999998, 1.4772656249999998, 1.4771874999999999, 1.3890624999999996, 1.4408593749999996, 1.462265625, 1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524422048153324, "mean_inference_ms": 2.529547206427951, "mean_action_processing_ms": 0.16258211171019432, "mean_env_wait_ms": 0.271449207197806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11034488677978516, "StateBufferConnector_ms": 0.008899211883544922, "ViewRequirementAgentConnector_ms": 0.151503324508667}}, "episode_reward_max": 1.48015625, "episode_reward_min": 0.47109374999999554, "episode_reward_mean": 1.4066234374999993, "episode_len_mean": 124.0, "episodes_this_iter": 52, "policy_reward_min": {"red_0": 0.47109374999999554}, "policy_reward_max": {"red_0": 1.48015625}, "policy_reward_mean": {"red_0": 1.4066234374999993}, "hist_stats": {"episode_reward": [1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875, 1.4049999999999998, 1.47078125, 1.4220312499999996, 1.448203125, 1.4330468749999998, 1.468046875, 1.47265625, 1.454453125, 1.4657031249999997, 1.47125, 1.423671875, 1.309453124999999, 1.4450781249999998, 1.4358593749999997, 1.4765625, 1.4119531249999997, 1.4637499999999999, 1.4674218749999999, 1.4721093749999998, 1.472265625, 1.3946874999999996, 1.46078125, 1.4772656249999998, 1.4772656249999998, 1.4771874999999999, 1.3890624999999996, 1.4408593749999996, 1.462265625, 1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125], "episode_lengths": [217, 156, 64, 57, 1280, 140, 45, 61, 143, 87, 85, 55, 68, 59, 145, 106, 88, 86, 224, 100, 58, 64, 81, 115, 87, 57, 1280, 183, 71, 649, 55, 56, 43, 54, 36, 80, 49, 99, 65, 169, 58, 84, 54, 56, 132, 41, 103, 70, 130, 40, 106, 71, 91, 45, 38, 63, 47, 40, 103, 259, 75, 89, 32, 121, 50, 45, 39, 39, 146, 54, 31, 31, 32, 154, 81, 53, 169, 48, 42, 34, 59, 35, 87, 1280, 81, 28, 47, 80, 64, 48, 42, 141, 88, 74, 103, 37, 83, 185, 79, 146], "policy_red_0_reward": [1.3410156249999996, 1.3868749999999999, 1.453125, 1.4586718749999998, 0.47109374999999554, 1.3982812499999997, 1.467109375, 1.4552343749999999, 1.3971093749999997, 1.4360156249999998, 1.4361718749999997, 1.4596093749999999, 1.4490625, 1.456640625, 1.3944531249999996, 1.4228124999999996, 1.4362499999999998, 1.4346875, 1.3374999999999995, 1.4273437499999997, 1.45828125, 1.4528124999999998, 1.4403906249999996, 1.4152343749999996, 1.436640625, 1.458359375, 0.4728124999999958, 1.3552343749999998, 1.4475781249999997, 1.031015624999998, 1.4608593749999998, 1.4590625, 1.466640625, 1.4610937499999999, 1.47375, 1.4420312499999999, 1.463671875, 1.4274218749999998, 1.4524218749999998, 1.3772656249999997, 1.4574999999999998, 1.4395312499999997, 1.4609374999999998, 1.45828125, 1.4012499999999997, 1.469453125, 1.4250781249999998, 1.4496875, 1.4049999999999998, 1.47078125, 1.4220312499999996, 1.448203125, 1.4330468749999998, 1.468046875, 1.47265625, 1.454453125, 1.4657031249999997, 1.47125, 1.423671875, 1.309453124999999, 1.4450781249999998, 1.4358593749999997, 1.4765625, 1.4119531249999997, 1.4637499999999999, 1.4674218749999999, 1.4721093749999998, 1.472265625, 1.3946874999999996, 1.46078125, 1.4772656249999998, 1.4772656249999998, 1.4771874999999999, 1.3890624999999996, 1.4408593749999996, 1.462265625, 1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.524422048153324, "mean_inference_ms": 2.529547206427951, "mean_action_processing_ms": 0.16258211171019432, "mean_env_wait_ms": 0.271449207197806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11034488677978516, "StateBufferConnector_ms": 0.008899211883544922, "ViewRequirementAgentConnector_ms": 0.151503324508667}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.81643338474942, "num_env_steps_trained_throughput_per_sec": 73.81643338474942, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 51347.255, "sample_time_ms": 13836.481, "learn_time_ms": 37438.885, "learn_throughput": 106.841, "synch_weights_time_ms": 70.905}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 165, "training_iteration": 13, "trial_id": "43ced_00000", "date": "2023-09-14_19-31-52", "timestamp": 1694734312, "time_this_iter_s": 54.203171730041504, "time_total_s": 681.1546351909637, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b1c2ed750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 681.1546351909637, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 84.42692307692306, "ram_util_percent": 9.641025641025644}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.99, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6769545113667845, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0036742713242953564, "policy_loss": -0.030481338555303713, "vf_loss": 0.02223022034643994, "vf_explained_var": 0.4632083215440313, "kl": 0.015256157179273488, "entropy": 1.4763243898749352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 1.483515625, "episode_reward_min": 0.47671874999999647, "episode_reward_mean": 1.4439226562499996, "episode_len_mean": 75.93, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {"red_0": 0.47671874999999647}, "policy_reward_max": {"red_0": 1.483515625}, "policy_reward_mean": {"red_0": 1.4439226562499996}, "custom_metrics": {"red_0/door_open_done_mean": 0.99, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125, 1.3899999999999997, 1.456015625, 1.4500781249999997, 1.476484375, 1.4671875, 1.4621874999999998, 1.4275781249999997, 1.4660156249999998, 1.4567187499999998, 1.4439843749999997, 1.47265625, 1.4393749999999998, 1.472734375, 1.46125, 1.4675, 1.4689062499999999, 1.469765625, 1.4784375, 1.4746093749999998, 1.4782812499999998, 1.46828125, 1.458125, 1.4525, 1.462890625, 1.472109375, 1.4747656249999999, 1.4608593749999998, 1.46421875, 1.4630468749999999, 1.465859375, 1.476875, 1.45046875, 1.4689843749999998, 1.4436718749999997, 1.4758593749999998, 1.4758593749999998, 1.4443749999999995, 1.385078125, 1.479296875, 1.4476562499999999, 1.3781249999999998, 1.4542968749999998, 1.4746875, 1.47703125, 1.4721875, 1.46703125, 1.370156249999999, 1.42546875, 1.4624218749999998, 1.4536718749999997, 1.4565625, 1.47421875, 1.3731249999999995, 1.448046875, 1.425859375, 1.4807031249999998, 1.4690625, 1.466328125, 1.44734375, 1.45421875, 1.446015625, 1.4796875, 1.4713281249999999, 1.483515625, 1.4389062499999998, 1.47703125, 1.4632031249999997, 1.467578125, 1.4477343749999998, 1.466875, 1.47875, 1.4546875, 1.468359375, 1.4377343749999996, 1.4664843749999998, 1.48296875], "episode_lengths": [169, 48, 42, 34, 59, 35, 87, 1280, 81, 28, 47, 80, 64, 48, 42, 141, 88, 74, 103, 37, 83, 185, 79, 146, 152, 61, 69, 33, 46, 52, 99, 47, 60, 77, 38, 84, 37, 54, 46, 42, 41, 30, 35, 30, 44, 58, 66, 51, 39, 35, 55, 50, 51, 47, 32, 68, 43, 77, 33, 33, 76, 159, 29, 72, 170, 63, 36, 32, 38, 46, 176, 104, 51, 63, 60, 36, 176, 73, 103, 27, 42, 47, 72, 62, 75, 28, 39, 23, 84, 32, 51, 45, 71, 46, 30, 62, 43, 85, 47, 24], "policy_red_0_reward": [1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125, 1.3899999999999997, 1.456015625, 1.4500781249999997, 1.476484375, 1.4671875, 1.4621874999999998, 1.4275781249999997, 1.4660156249999998, 1.4567187499999998, 1.4439843749999997, 1.47265625, 1.4393749999999998, 1.472734375, 1.46125, 1.4675, 1.4689062499999999, 1.469765625, 1.4784375, 1.4746093749999998, 1.4782812499999998, 1.46828125, 1.458125, 1.4525, 1.462890625, 1.472109375, 1.4747656249999999, 1.4608593749999998, 1.46421875, 1.4630468749999999, 1.465859375, 1.476875, 1.45046875, 1.4689843749999998, 1.4436718749999997, 1.4758593749999998, 1.4758593749999998, 1.4443749999999995, 1.385078125, 1.479296875, 1.4476562499999999, 1.3781249999999998, 1.4542968749999998, 1.4746875, 1.47703125, 1.4721875, 1.46703125, 1.370156249999999, 1.42546875, 1.4624218749999998, 1.4536718749999997, 1.4565625, 1.47421875, 1.3731249999999995, 1.448046875, 1.425859375, 1.4807031249999998, 1.4690625, 1.466328125, 1.44734375, 1.45421875, 1.446015625, 1.4796875, 1.4713281249999999, 1.483515625, 1.4389062499999998, 1.47703125, 1.4632031249999997, 1.467578125, 1.4477343749999998, 1.466875, 1.47875, 1.4546875, 1.468359375, 1.4377343749999996, 1.4664843749999998, 1.48296875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5239523677986743, "mean_inference_ms": 2.507758156104369, "mean_action_processing_ms": 0.16166201286833676, "mean_env_wait_ms": 0.27073133123723964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11845636367797852, "StateBufferConnector_ms": 0.0077326297760009766, "ViewRequirementAgentConnector_ms": 0.15296006202697754}}, "episode_reward_max": 1.483515625, "episode_reward_min": 0.47671874999999647, "episode_reward_mean": 1.4439226562499996, "episode_len_mean": 75.93, "episodes_this_iter": 76, "policy_reward_min": {"red_0": 0.47671874999999647}, "policy_reward_max": {"red_0": 1.483515625}, "policy_reward_mean": {"red_0": 1.4439226562499996}, "hist_stats": {"episode_reward": [1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125, 1.3899999999999997, 1.456015625, 1.4500781249999997, 1.476484375, 1.4671875, 1.4621874999999998, 1.4275781249999997, 1.4660156249999998, 1.4567187499999998, 1.4439843749999997, 1.47265625, 1.4393749999999998, 1.472734375, 1.46125, 1.4675, 1.4689062499999999, 1.469765625, 1.4784375, 1.4746093749999998, 1.4782812499999998, 1.46828125, 1.458125, 1.4525, 1.462890625, 1.472109375, 1.4747656249999999, 1.4608593749999998, 1.46421875, 1.4630468749999999, 1.465859375, 1.476875, 1.45046875, 1.4689843749999998, 1.4436718749999997, 1.4758593749999998, 1.4758593749999998, 1.4443749999999995, 1.385078125, 1.479296875, 1.4476562499999999, 1.3781249999999998, 1.4542968749999998, 1.4746875, 1.47703125, 1.4721875, 1.46703125, 1.370156249999999, 1.42546875, 1.4624218749999998, 1.4536718749999997, 1.4565625, 1.47421875, 1.3731249999999995, 1.448046875, 1.425859375, 1.4807031249999998, 1.4690625, 1.466328125, 1.44734375, 1.45421875, 1.446015625, 1.4796875, 1.4713281249999999, 1.483515625, 1.4389062499999998, 1.47703125, 1.4632031249999997, 1.467578125, 1.4477343749999998, 1.466875, 1.47875, 1.4546875, 1.468359375, 1.4377343749999996, 1.4664843749999998, 1.48296875], "episode_lengths": [169, 48, 42, 34, 59, 35, 87, 1280, 81, 28, 47, 80, 64, 48, 42, 141, 88, 74, 103, 37, 83, 185, 79, 146, 152, 61, 69, 33, 46, 52, 99, 47, 60, 77, 38, 84, 37, 54, 46, 42, 41, 30, 35, 30, 44, 58, 66, 51, 39, 35, 55, 50, 51, 47, 32, 68, 43, 77, 33, 33, 76, 159, 29, 72, 170, 63, 36, 32, 38, 46, 176, 104, 51, 63, 60, 36, 176, 73, 103, 27, 42, 47, 72, 62, 75, 28, 39, 23, 84, 32, 51, 45, 71, 46, 30, 62, 43, 85, 47, 24], "policy_red_0_reward": [1.3752343749999993, 1.465625, 1.4695312499999997, 1.47609375, 1.4569531249999996, 1.4746093749999998, 1.4358593749999997, 0.47671874999999647, 1.4411718749999998, 1.48015625, 1.466328125, 1.4425, 1.4531249999999998, 1.46515625, 1.4695312499999997, 1.3957031249999998, 1.4349999999999998, 1.4459374999999999, 1.4241406249999995, 1.473203125, 1.439921875, 1.3619531249999994, 1.4427343749999997, 1.393125, 1.3899999999999997, 1.456015625, 1.4500781249999997, 1.476484375, 1.4671875, 1.4621874999999998, 1.4275781249999997, 1.4660156249999998, 1.4567187499999998, 1.4439843749999997, 1.47265625, 1.4393749999999998, 1.472734375, 1.46125, 1.4675, 1.4689062499999999, 1.469765625, 1.4784375, 1.4746093749999998, 1.4782812499999998, 1.46828125, 1.458125, 1.4525, 1.462890625, 1.472109375, 1.4747656249999999, 1.4608593749999998, 1.46421875, 1.4630468749999999, 1.465859375, 1.476875, 1.45046875, 1.4689843749999998, 1.4436718749999997, 1.4758593749999998, 1.4758593749999998, 1.4443749999999995, 1.385078125, 1.479296875, 1.4476562499999999, 1.3781249999999998, 1.4542968749999998, 1.4746875, 1.47703125, 1.4721875, 1.46703125, 1.370156249999999, 1.42546875, 1.4624218749999998, 1.4536718749999997, 1.4565625, 1.47421875, 1.3731249999999995, 1.448046875, 1.425859375, 1.4807031249999998, 1.4690625, 1.466328125, 1.44734375, 1.45421875, 1.446015625, 1.4796875, 1.4713281249999999, 1.483515625, 1.4389062499999998, 1.47703125, 1.4632031249999997, 1.467578125, 1.4477343749999998, 1.466875, 1.47875, 1.4546875, 1.468359375, 1.4377343749999996, 1.4664843749999998, 1.48296875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5239523677986743, "mean_inference_ms": 2.507758156104369, "mean_action_processing_ms": 0.16166201286833676, "mean_env_wait_ms": 0.27073133123723964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11845636367797852, "StateBufferConnector_ms": 0.0077326297760009766, "ViewRequirementAgentConnector_ms": 0.15296006202697754}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.02045847495361, "num_env_steps_trained_throughput_per_sec": 72.02045847495361, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 51297.657, "sample_time_ms": 13820.4, "learn_time_ms": 37400.794, "learn_throughput": 106.95, "synch_weights_time_ms": 75.464}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 241, "training_iteration": 14, "trial_id": "43ced_00000", "date": "2023-09-14_19-32-47", "timestamp": 1694734367, "time_this_iter_s": 55.553730487823486, "time_total_s": 736.7083656787872, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b1c1ee290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 736.7083656787872, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 83.70632911392404, "ram_util_percent": 9.736708860759494}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7334355945388475, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007505915541696595, "policy_loss": -0.031274241018885124, "vf_loss": 0.018356348177379307, "vf_explained_var": 0.5609877225011587, "kl": 0.01803992250287294, "entropy": 1.3256441292663415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 1.486484375, "episode_reward_min": 1.4189062499999998, "episode_reward_mean": 1.4723484374999996, "episode_len_mean": 38.42, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {"red_0": 1.4189062499999998}, "policy_reward_max": {"red_0": 1.486484375}, "policy_reward_mean": {"red_0": 1.4723484374999996}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.475546875, 1.482265625, 1.4753124999999998, 1.471796875, 1.473515625, 1.456171875, 1.483671875, 1.458984375, 1.4808593749999999, 1.476640625, 1.4793749999999999, 1.4740625, 1.4784374999999998, 1.4791406249999999, 1.482265625, 1.4815625, 1.4709374999999998, 1.470546875, 1.4642968749999998, 1.47453125, 1.466640625, 1.47390625, 1.471015625, 1.481953125, 1.47140625, 1.470703125, 1.473203125, 1.4723437499999998, 1.481953125, 1.477890625, 1.474921875, 1.4567968749999998, 1.483125, 1.458046875, 1.4782812499999998, 1.478515625, 1.478125, 1.4782031249999998, 1.478984375, 1.478984375, 1.479296875, 1.4747656249999999, 1.465078125, 1.47703125, 1.471953125, 1.4689843749999998, 1.4784374999999998, 1.4625, 1.4779687499999998, 1.4621874999999998, 1.4777343749999998, 1.48421875, 1.4807031249999998, 1.4808593749999999, 1.483828125, 1.4796875, 1.467109375, 1.479453125, 1.466328125, 1.4784374999999998, 1.4235156249999998, 1.47109375, 1.48265625, 1.481640625, 1.459296875, 1.4803125000000001, 1.455625, 1.47109375, 1.470703125, 1.4653125, 1.480546875, 1.46796875, 1.486484375, 1.481796875, 1.47078125, 1.4719531249999998, 1.483671875, 1.4796875, 1.4549999999999998, 1.47984375, 1.456640625, 1.4189062499999998, 1.464921875, 1.4703125, 1.478046875, 1.4660156249999998, 1.483125, 1.474921875, 1.4646875, 1.4784375, 1.4264062499999999, 1.47859375, 1.4669531249999999, 1.4754687499999999, 1.4815625, 1.47515625, 1.47484375, 1.4586718749999998, 1.47984375, 1.4708593749999999], "episode_lengths": [33, 25, 34, 39, 37, 61, 23, 55, 27, 33, 28, 36, 30, 29, 25, 26, 40, 41, 49, 36, 47, 36, 41, 25, 40, 41, 37, 38, 25, 31, 35, 59, 24, 59, 30, 29, 30, 31, 29, 29, 29, 35, 49, 32, 39, 43, 30, 52, 30, 52, 31, 22, 27, 27, 23, 28, 45, 29, 47, 30, 107, 40, 24, 25, 57, 28, 62, 40, 41, 48, 27, 44, 19, 25, 40, 39, 23, 28, 62, 28, 59, 114, 49, 42, 31, 47, 24, 35, 50, 30, 102, 30, 45, 34, 26, 34, 34, 57, 28, 41], "policy_red_0_reward": [1.475546875, 1.482265625, 1.4753124999999998, 1.471796875, 1.473515625, 1.456171875, 1.483671875, 1.458984375, 1.4808593749999999, 1.476640625, 1.4793749999999999, 1.4740625, 1.4784374999999998, 1.4791406249999999, 1.482265625, 1.4815625, 1.4709374999999998, 1.470546875, 1.4642968749999998, 1.47453125, 1.466640625, 1.47390625, 1.471015625, 1.481953125, 1.47140625, 1.470703125, 1.473203125, 1.4723437499999998, 1.481953125, 1.477890625, 1.474921875, 1.4567968749999998, 1.483125, 1.458046875, 1.4782812499999998, 1.478515625, 1.478125, 1.4782031249999998, 1.478984375, 1.478984375, 1.479296875, 1.4747656249999999, 1.465078125, 1.47703125, 1.471953125, 1.4689843749999998, 1.4784374999999998, 1.4625, 1.4779687499999998, 1.4621874999999998, 1.4777343749999998, 1.48421875, 1.4807031249999998, 1.4808593749999999, 1.483828125, 1.4796875, 1.467109375, 1.479453125, 1.466328125, 1.4784374999999998, 1.4235156249999998, 1.47109375, 1.48265625, 1.481640625, 1.459296875, 1.4803125000000001, 1.455625, 1.47109375, 1.470703125, 1.4653125, 1.480546875, 1.46796875, 1.486484375, 1.481796875, 1.47078125, 1.4719531249999998, 1.483671875, 1.4796875, 1.4549999999999998, 1.47984375, 1.456640625, 1.4189062499999998, 1.464921875, 1.4703125, 1.478046875, 1.4660156249999998, 1.483125, 1.474921875, 1.4646875, 1.4784375, 1.4264062499999999, 1.47859375, 1.4669531249999999, 1.4754687499999999, 1.4815625, 1.47515625, 1.47484375, 1.4586718749999998, 1.47984375, 1.4708593749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.529595525080791, "mean_inference_ms": 2.5280858599887335, "mean_action_processing_ms": 0.16175826297881424, "mean_env_wait_ms": 0.2719858689539394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1143195629119873, "StateBufferConnector_ms": 0.007811546325683594, "ViewRequirementAgentConnector_ms": 0.15410542488098145}}, "episode_reward_max": 1.486484375, "episode_reward_min": 1.4189062499999998, "episode_reward_mean": 1.4723484374999996, "episode_len_mean": 38.42, "episodes_this_iter": 100, "policy_reward_min": {"red_0": 1.4189062499999998}, "policy_reward_max": {"red_0": 1.486484375}, "policy_reward_mean": {"red_0": 1.4723484374999996}, "hist_stats": {"episode_reward": [1.475546875, 1.482265625, 1.4753124999999998, 1.471796875, 1.473515625, 1.456171875, 1.483671875, 1.458984375, 1.4808593749999999, 1.476640625, 1.4793749999999999, 1.4740625, 1.4784374999999998, 1.4791406249999999, 1.482265625, 1.4815625, 1.4709374999999998, 1.470546875, 1.4642968749999998, 1.47453125, 1.466640625, 1.47390625, 1.471015625, 1.481953125, 1.47140625, 1.470703125, 1.473203125, 1.4723437499999998, 1.481953125, 1.477890625, 1.474921875, 1.4567968749999998, 1.483125, 1.458046875, 1.4782812499999998, 1.478515625, 1.478125, 1.4782031249999998, 1.478984375, 1.478984375, 1.479296875, 1.4747656249999999, 1.465078125, 1.47703125, 1.471953125, 1.4689843749999998, 1.4784374999999998, 1.4625, 1.4779687499999998, 1.4621874999999998, 1.4777343749999998, 1.48421875, 1.4807031249999998, 1.4808593749999999, 1.483828125, 1.4796875, 1.467109375, 1.479453125, 1.466328125, 1.4784374999999998, 1.4235156249999998, 1.47109375, 1.48265625, 1.481640625, 1.459296875, 1.4803125000000001, 1.455625, 1.47109375, 1.470703125, 1.4653125, 1.480546875, 1.46796875, 1.486484375, 1.481796875, 1.47078125, 1.4719531249999998, 1.483671875, 1.4796875, 1.4549999999999998, 1.47984375, 1.456640625, 1.4189062499999998, 1.464921875, 1.4703125, 1.478046875, 1.4660156249999998, 1.483125, 1.474921875, 1.4646875, 1.4784375, 1.4264062499999999, 1.47859375, 1.4669531249999999, 1.4754687499999999, 1.4815625, 1.47515625, 1.47484375, 1.4586718749999998, 1.47984375, 1.4708593749999999], "episode_lengths": [33, 25, 34, 39, 37, 61, 23, 55, 27, 33, 28, 36, 30, 29, 25, 26, 40, 41, 49, 36, 47, 36, 41, 25, 40, 41, 37, 38, 25, 31, 35, 59, 24, 59, 30, 29, 30, 31, 29, 29, 29, 35, 49, 32, 39, 43, 30, 52, 30, 52, 31, 22, 27, 27, 23, 28, 45, 29, 47, 30, 107, 40, 24, 25, 57, 28, 62, 40, 41, 48, 27, 44, 19, 25, 40, 39, 23, 28, 62, 28, 59, 114, 49, 42, 31, 47, 24, 35, 50, 30, 102, 30, 45, 34, 26, 34, 34, 57, 28, 41], "policy_red_0_reward": [1.475546875, 1.482265625, 1.4753124999999998, 1.471796875, 1.473515625, 1.456171875, 1.483671875, 1.458984375, 1.4808593749999999, 1.476640625, 1.4793749999999999, 1.4740625, 1.4784374999999998, 1.4791406249999999, 1.482265625, 1.4815625, 1.4709374999999998, 1.470546875, 1.4642968749999998, 1.47453125, 1.466640625, 1.47390625, 1.471015625, 1.481953125, 1.47140625, 1.470703125, 1.473203125, 1.4723437499999998, 1.481953125, 1.477890625, 1.474921875, 1.4567968749999998, 1.483125, 1.458046875, 1.4782812499999998, 1.478515625, 1.478125, 1.4782031249999998, 1.478984375, 1.478984375, 1.479296875, 1.4747656249999999, 1.465078125, 1.47703125, 1.471953125, 1.4689843749999998, 1.4784374999999998, 1.4625, 1.4779687499999998, 1.4621874999999998, 1.4777343749999998, 1.48421875, 1.4807031249999998, 1.4808593749999999, 1.483828125, 1.4796875, 1.467109375, 1.479453125, 1.466328125, 1.4784374999999998, 1.4235156249999998, 1.47109375, 1.48265625, 1.481640625, 1.459296875, 1.4803125000000001, 1.455625, 1.47109375, 1.470703125, 1.4653125, 1.480546875, 1.46796875, 1.486484375, 1.481796875, 1.47078125, 1.4719531249999998, 1.483671875, 1.4796875, 1.4549999999999998, 1.47984375, 1.456640625, 1.4189062499999998, 1.464921875, 1.4703125, 1.478046875, 1.4660156249999998, 1.483125, 1.474921875, 1.4646875, 1.4784375, 1.4264062499999999, 1.47859375, 1.4669531249999999, 1.4754687499999999, 1.4815625, 1.47515625, 1.47484375, 1.4586718749999998, 1.47984375, 1.4708593749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.529595525080791, "mean_inference_ms": 2.5280858599887335, "mean_action_processing_ms": 0.16175826297881424, "mean_env_wait_ms": 0.2719858689539394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1143195629119873, "StateBufferConnector_ms": 0.007811546325683594, "ViewRequirementAgentConnector_ms": 0.15410542488098145}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.0216749745079, "num_env_steps_trained_throughput_per_sec": 76.0216749745079, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 51641.105, "sample_time_ms": 13783.051, "learn_time_ms": 37782.592, "learn_throughput": 105.869, "synch_weights_time_ms": 74.468}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 341, "training_iteration": 15, "trial_id": "43ced_00000", "date": "2023-09-14_19-33-40", "timestamp": 1694734420, "time_this_iter_s": 52.63220500946045, "time_total_s": 789.3405706882477, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f0b1c2efbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 789.3405706882477, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 83.40921052631577, "ram_util_percent": 9.839473684210526}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.79803207864364, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.001193827184154846, "policy_loss": -0.024376083197421395, "vf_loss": 0.01935471895170243, "vf_explained_var": 0.5673666747286916, "kl": 0.01275845791041938, "entropy": 1.2520188235988219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 1.48875, "episode_reward_min": 1.37828125, "episode_reward_mean": 1.4739035326086956, "episode_len_mean": 36.36521739130435, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {"red_0": 1.37828125}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.4739035326086956}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.441484375, 1.483671875, 1.458046875, 1.483125, 1.4798437500000001, 1.4633593749999998, 1.4815625, 1.48296875, 1.473671875, 1.4771874999999999, 1.478125, 1.48578125, 1.483515625, 1.438515625, 1.440625, 1.4767187499999999, 1.4396093749999999, 1.477890625, 1.4798437500000001, 1.4777343749999998, 1.4859375, 1.481015625, 1.4577343749999998, 1.4808593749999999, 1.47875, 1.48171875, 1.476171875, 1.473125, 1.47859375, 1.48296875, 1.480546875, 1.476171875, 1.47703125, 1.48234375, 1.4733593749999998, 1.4500781249999999, 1.4861718750000001, 1.4642968749999998, 1.4784374999999998, 1.4803906249999998, 1.478984375, 1.4689843749999998, 1.485625, 1.483515625, 1.470234375, 1.48, 1.47546875, 1.483828125, 1.478984375, 1.47125, 1.445859375, 1.48, 1.4734375, 1.48015625, 1.4694531249999998, 1.48, 1.47578125, 1.4803125000000001, 1.48734375, 1.45609375, 1.456640625, 1.48265625, 1.479296875, 1.47140625, 1.47859375, 1.475078125, 1.4796874999999998, 1.483671875, 1.4730468749999999, 1.4500781249999997, 1.4701562499999998, 1.4753124999999998, 1.48875, 1.474375, 1.47390625, 1.47296875, 1.483671875, 1.4791406249999999, 1.47875, 1.4782031249999998, 1.474375, 1.479296875, 1.4654687499999999, 1.37828125, 1.476328125, 1.474921875, 1.484375, 1.4808593749999999, 1.4796874999999998, 1.4286718749999998, 1.4871874999999999, 1.479296875, 1.4871874999999999, 1.48, 1.4660156249999998, 1.46828125, 1.484375, 1.4775, 1.488046875, 1.48, 1.4746093749999998, 1.482421875, 1.4628906249999998, 1.4721875, 1.481953125, 1.48, 1.4797656249999998, 1.483359375, 1.4821093749999998, 1.48421875, 1.482265625, 1.4810937499999999, 1.435625, 1.4728906249999998, 1.483671875], "episode_lengths": [81, 23, 59, 24, 28, 51, 26, 24, 37, 32, 30, 20, 23, 85, 84, 32, 83, 31, 28, 31, 20, 27, 59, 27, 30, 26, 33, 38, 30, 24, 27, 33, 32, 24, 37, 69, 19, 49, 30, 27, 29, 43, 20, 23, 41, 28, 34, 23, 29, 40, 75, 28, 36, 28, 43, 28, 34, 28, 18, 62, 61, 24, 29, 40, 30, 35, 28, 23, 37, 69, 40, 34, 16, 36, 36, 38, 23, 29, 30, 31, 36, 29, 48, 170, 33, 35, 22, 27, 28, 99, 18, 29, 18, 28, 47, 44, 22, 32, 17, 28, 35, 25, 51, 38, 25, 28, 27, 23, 25, 22, 25, 26, 90, 37, 23], "policy_red_0_reward": [1.441484375, 1.483671875, 1.458046875, 1.483125, 1.4798437500000001, 1.4633593749999998, 1.4815625, 1.48296875, 1.473671875, 1.4771874999999999, 1.478125, 1.48578125, 1.483515625, 1.438515625, 1.440625, 1.4767187499999999, 1.4396093749999999, 1.477890625, 1.4798437500000001, 1.4777343749999998, 1.4859375, 1.481015625, 1.4577343749999998, 1.4808593749999999, 1.47875, 1.48171875, 1.476171875, 1.473125, 1.47859375, 1.48296875, 1.480546875, 1.476171875, 1.47703125, 1.48234375, 1.4733593749999998, 1.4500781249999999, 1.4861718750000001, 1.4642968749999998, 1.4784374999999998, 1.4803906249999998, 1.478984375, 1.4689843749999998, 1.485625, 1.483515625, 1.470234375, 1.48, 1.47546875, 1.483828125, 1.478984375, 1.47125, 1.445859375, 1.48, 1.4734375, 1.48015625, 1.4694531249999998, 1.48, 1.47578125, 1.4803125000000001, 1.48734375, 1.45609375, 1.456640625, 1.48265625, 1.479296875, 1.47140625, 1.47859375, 1.475078125, 1.4796874999999998, 1.483671875, 1.4730468749999999, 1.4500781249999997, 1.4701562499999998, 1.4753124999999998, 1.48875, 1.474375, 1.47390625, 1.47296875, 1.483671875, 1.4791406249999999, 1.47875, 1.4782031249999998, 1.474375, 1.479296875, 1.4654687499999999, 1.37828125, 1.476328125, 1.474921875, 1.484375, 1.4808593749999999, 1.4796874999999998, 1.4286718749999998, 1.4871874999999999, 1.479296875, 1.4871874999999999, 1.48, 1.4660156249999998, 1.46828125, 1.484375, 1.4775, 1.488046875, 1.48, 1.4746093749999998, 1.482421875, 1.4628906249999998, 1.4721875, 1.481953125, 1.48, 1.4797656249999998, 1.483359375, 1.4821093749999998, 1.48421875, 1.482265625, 1.4810937499999999, 1.435625, 1.4728906249999998, 1.483671875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344432916239162, "mean_inference_ms": 2.5432762615425943, "mean_action_processing_ms": 0.16208894784454922, "mean_env_wait_ms": 0.27351854051925373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12375479159147842, "StateBufferConnector_ms": 0.008198696634043818, "ViewRequirementAgentConnector_ms": 0.15968219093654468}}, "episode_reward_max": 1.48875, "episode_reward_min": 1.37828125, "episode_reward_mean": 1.4739035326086956, "episode_len_mean": 36.36521739130435, "episodes_this_iter": 115, "policy_reward_min": {"red_0": 1.37828125}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.4739035326086956}, "hist_stats": {"episode_reward": [1.441484375, 1.483671875, 1.458046875, 1.483125, 1.4798437500000001, 1.4633593749999998, 1.4815625, 1.48296875, 1.473671875, 1.4771874999999999, 1.478125, 1.48578125, 1.483515625, 1.438515625, 1.440625, 1.4767187499999999, 1.4396093749999999, 1.477890625, 1.4798437500000001, 1.4777343749999998, 1.4859375, 1.481015625, 1.4577343749999998, 1.4808593749999999, 1.47875, 1.48171875, 1.476171875, 1.473125, 1.47859375, 1.48296875, 1.480546875, 1.476171875, 1.47703125, 1.48234375, 1.4733593749999998, 1.4500781249999999, 1.4861718750000001, 1.4642968749999998, 1.4784374999999998, 1.4803906249999998, 1.478984375, 1.4689843749999998, 1.485625, 1.483515625, 1.470234375, 1.48, 1.47546875, 1.483828125, 1.478984375, 1.47125, 1.445859375, 1.48, 1.4734375, 1.48015625, 1.4694531249999998, 1.48, 1.47578125, 1.4803125000000001, 1.48734375, 1.45609375, 1.456640625, 1.48265625, 1.479296875, 1.47140625, 1.47859375, 1.475078125, 1.4796874999999998, 1.483671875, 1.4730468749999999, 1.4500781249999997, 1.4701562499999998, 1.4753124999999998, 1.48875, 1.474375, 1.47390625, 1.47296875, 1.483671875, 1.4791406249999999, 1.47875, 1.4782031249999998, 1.474375, 1.479296875, 1.4654687499999999, 1.37828125, 1.476328125, 1.474921875, 1.484375, 1.4808593749999999, 1.4796874999999998, 1.4286718749999998, 1.4871874999999999, 1.479296875, 1.4871874999999999, 1.48, 1.4660156249999998, 1.46828125, 1.484375, 1.4775, 1.488046875, 1.48, 1.4746093749999998, 1.482421875, 1.4628906249999998, 1.4721875, 1.481953125, 1.48, 1.4797656249999998, 1.483359375, 1.4821093749999998, 1.48421875, 1.482265625, 1.4810937499999999, 1.435625, 1.4728906249999998, 1.483671875], "episode_lengths": [81, 23, 59, 24, 28, 51, 26, 24, 37, 32, 30, 20, 23, 85, 84, 32, 83, 31, 28, 31, 20, 27, 59, 27, 30, 26, 33, 38, 30, 24, 27, 33, 32, 24, 37, 69, 19, 49, 30, 27, 29, 43, 20, 23, 41, 28, 34, 23, 29, 40, 75, 28, 36, 28, 43, 28, 34, 28, 18, 62, 61, 24, 29, 40, 30, 35, 28, 23, 37, 69, 40, 34, 16, 36, 36, 38, 23, 29, 30, 31, 36, 29, 48, 170, 33, 35, 22, 27, 28, 99, 18, 29, 18, 28, 47, 44, 22, 32, 17, 28, 35, 25, 51, 38, 25, 28, 27, 23, 25, 22, 25, 26, 90, 37, 23], "policy_red_0_reward": [1.441484375, 1.483671875, 1.458046875, 1.483125, 1.4798437500000001, 1.4633593749999998, 1.4815625, 1.48296875, 1.473671875, 1.4771874999999999, 1.478125, 1.48578125, 1.483515625, 1.438515625, 1.440625, 1.4767187499999999, 1.4396093749999999, 1.477890625, 1.4798437500000001, 1.4777343749999998, 1.4859375, 1.481015625, 1.4577343749999998, 1.4808593749999999, 1.47875, 1.48171875, 1.476171875, 1.473125, 1.47859375, 1.48296875, 1.480546875, 1.476171875, 1.47703125, 1.48234375, 1.4733593749999998, 1.4500781249999999, 1.4861718750000001, 1.4642968749999998, 1.4784374999999998, 1.4803906249999998, 1.478984375, 1.4689843749999998, 1.485625, 1.483515625, 1.470234375, 1.48, 1.47546875, 1.483828125, 1.478984375, 1.47125, 1.445859375, 1.48, 1.4734375, 1.48015625, 1.4694531249999998, 1.48, 1.47578125, 1.4803125000000001, 1.48734375, 1.45609375, 1.456640625, 1.48265625, 1.479296875, 1.47140625, 1.47859375, 1.475078125, 1.4796874999999998, 1.483671875, 1.4730468749999999, 1.4500781249999997, 1.4701562499999998, 1.4753124999999998, 1.48875, 1.474375, 1.47390625, 1.47296875, 1.483671875, 1.4791406249999999, 1.47875, 1.4782031249999998, 1.474375, 1.479296875, 1.4654687499999999, 1.37828125, 1.476328125, 1.474921875, 1.484375, 1.4808593749999999, 1.4796874999999998, 1.4286718749999998, 1.4871874999999999, 1.479296875, 1.4871874999999999, 1.48, 1.4660156249999998, 1.46828125, 1.484375, 1.4775, 1.488046875, 1.48, 1.4746093749999998, 1.482421875, 1.4628906249999998, 1.4721875, 1.481953125, 1.48, 1.4797656249999998, 1.483359375, 1.4821093749999998, 1.48421875, 1.482265625, 1.4810937499999999, 1.435625, 1.4728906249999998, 1.483671875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5344432916239162, "mean_inference_ms": 2.5432762615425943, "mean_action_processing_ms": 0.16208894784454922, "mean_env_wait_ms": 0.27351854051925373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12375479159147842, "StateBufferConnector_ms": 0.008198696634043818, "ViewRequirementAgentConnector_ms": 0.15968219093654468}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 69.32323731358737, "num_env_steps_trained_throughput_per_sec": 69.32323731358737, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 52697.504, "sample_time_ms": 13912.857, "learn_time_ms": 38709.035, "learn_throughput": 103.335, "synch_weights_time_ms": 74.623}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 456, "training_iteration": 16, "trial_id": "43ced_00000", "date": "2023-09-14_19-34-38", "timestamp": 1694734478, "time_this_iter_s": 57.71961951255798, "time_total_s": 847.0601902008057, "pid": 1965, "hostname": "str-win-3843", "node_ip": "172.20.79.65", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.00015625}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x7f088abd77f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 847.0601902008057, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 83.51951219512196, "ram_util_percent": 9.941463414634146}}
